<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Home</title>
    {% load staticfiles %}
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
    <link rel="stylesheet" href="{% static "styles.css" %}">

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
    <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
</head>
<body>
<div>
    <nav class="navbar navbar-inverse">
        <div class="container-fluid">
            <div class="navbar-header">
                <a class="navbar-brand" href="#">SafeCollab</a>
            </div>
            <ul class="nav navbar-nav">
                <li><a href="/myapplication">Home</a></li>
                <li><a href="/myapplication/manager">Manager</a></li>
                <li><a href="#">Groups</a></li>
                <li><a href="/myapplication/messaging">Messages</a></li>
                <li class="active"><a href="/myapplication/reports">Reports</a></li>
            </ul>
            <form role="search" class="navbar-form navbar-right">
                <div class="form-group">
                    <input type="text" placeholder="Search" class="form-control">
                </div>
            </form>
            <ul class="nav navbar-nav navbar-right">
                <li><a href="/myapplication/login"><span class="glyphicon glyphicon-log-in"></span> Login</a></li>
            </ul>
        </div>
    </nav>
</div>
<div class="cotainer">
    <div class="container">
        <h1>Reports</h1>
        {% if user.is_authenticated %}
            <h3>Filter:</h3>
            <form enctype="multipart/form-data" class="form-horizontal" id="filter-form" method="POST" action="/myapplication/reports/">
                {% csrf_token %}
                <div id="conditions">
                    <div class="row">
                        <div class="col-xs-2">
                            <div class="form-group">
                                <input name="con1" value="AND" hidden>
                            </div>
                        </div>
                        <div class="col-xs-2">
                            <div class="form-group">
                                <select name="cat1" class="form-control">
                                    <option>Description</option>
                                    <option>Reporter</option>
                                    <option>Created After</option>
                                    <option>Created Before</option>
                                    <option>Created On</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-xs-8">
                            <div class="form-group">
                                <input name="val1" type="text" class="form-control" aria-label="...">
                            </div>
                        </div>
                    </div>
                </div><!-- /input-group -->
                <br>
                <button id="add-field" type="button" class="btn btn-default">Add Field</button>
                <button type="submit" class="btn btn-default">Submit</button>
            </form>
            {% if Reports %}
                <table class="table table-striped table-hover">
                    <thead>
                    <tr>
                        <th>Description</th>
                        <th>Owner</th>
                        <th>Date</th>
                        <th>Content</th>
                        <th>Private</th>
                        <th>Edit</th>
                    </tr>
                    </thead>
                    <tbody>
                    {% for report in Reports %}
                        <tr>
                            <td>{{ report.description }}</td>
                            <td>{{ report.author }}</td>
                            <td>{{ report.date }}</td>
                            <td>{{ report.content }}</td>
                            <td>{{ report.security }}</td>
                            <td>{% if report.author.username == user.username %}
                            <form class="edit-form" action="../editreport/" method="post">
                                    {% csrf_token %}
                                    <input hidden type="text" name="reportID" value="{{ report.id }}">
                                    <button name="edit-btn" value="Click" type="submit"
                                            class="btn btn-danger delete-btn">
                                    Edit
                                    </button>
                            </form>
                            <form class="delete-form" action="#" method="post">
                            {% csrf_token %}
                            <input hidden type="text" name="reportID" value="{{ report.id }}">
                                    <button name="delete-btn" value="Click" type="submit"
                                            class="btn btn-danger delete-btn">
                                    Delete
                                    </button>
                            </form>
                        {% endif %}</td>
                        </tr>
                    {% endfor %}
                    </tbody>
                </table>
                <a href="/myapplication/makereport/">Make a New Report</a>
            {% endif %}
        {% else %}
            <h1>You are not logged in</h1>
            <a href="/myapplication/register/">Register Here</a><br>
        {% endif %}
    </div>
</div>
<script type="text/javascript">
    var cons = 1;
    $(function () {

        $("#add-field").click(function () {
            cons += 1;
            $("#conditions").append(
                    "<div class='row'> <div class='col-xs-2'> <div class='form-group'> <select name='con" + cons + "' class='form-control'> <option>AND</option> <option>OR</option></select> </div> </div> <div class='col-xs-2'> <div class='form-group'> <select name='cat" + cons + "' class='form-control'> <option>Description</option> <option>Reporter</option> <option>Created After</option> <option>Created Before</option> <option>Created On</option> </select> </div> </div> <div class='col-xs-8'> <div class='form-group'> <input name='val" + cons + "' type='text' class='form-control' aria-label='...'> </div> </div> </div>"
            );
            loadClickFunction();
        });

        function loadClickFunction() {
            $(".dropdown-menu li a").click(function () {
                var selText = $(this).text();
                $(this).parents('.input-group-btn').find('.dropdown-toggle').html(selText + ' <span class="caret"></span>');
            });

        }
    });
</script>
</body>
</html>